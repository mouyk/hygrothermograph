C51 COMPILER V9.60.0.0   SYSTEM_CLOCK                                                      06/24/2023 12:55:00 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE SYSTEM_CLOCK
OBJECT MODULE PLACED IN .\output\system_clock.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE source\system_clock.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(.\inclu
                    -de;.\source;.\include) DEBUG PRINT(.\lst\system_clock.lst) TABS(2) OBJECT(.\output\system_clock.obj)

line level    source

   1          #ifndef _SYSTEM_CLOCK_C_
   2          #define _SYSTEM_CLOCK_C_
   3          /*********************************************************************************************************
             -************/
   4          #include "include/ca51f_config.h"   
   5          #include "include/ca51f2sfr.h"
   6          #include "include/ca51f2xsfr.h"
   7          #include "include/gpiodef_f2.h"
   8          #include "include/system_clock.h"
   9          
  10          #include "include/delay.h"
  11          #include <intrins.h>
  12          /*********************************************************************************************************
             -************/
  13          
  14          
  15          /***********************************************************************************
  16          函数名  ：    Sys_Clk_Set_IRCH                      
  17          功能描述：    设置系统时钟为IRCH
  18          输入参数：    无
  19          返回值  ：    无
  20          ***********************************************************************************/
  21          void Sys_Clk_Set_IRCH(void)
  22          {
  23   1        CKCON |= IHCKE;                     //IRCH时钟使能
  24   1        CKSEL = (CKSEL&0xF8) | CKSEL_IRCH;  //系统时钟切换到IRCH
  25   1      }
  26          /***********************************************************************************/
  27          
  28          
  29          
  30          /***********************************************************************************
  31          函数名  ：    Sys_Clk_Set_IRCL                      
  32          功能描述：    设置系统时钟为IRCL
  33          输入参数：    无
  34          返回值  ：    无
  35          ***********************************************************************************/
  36          void Sys_Clk_Set_IRCL(void)
  37          {
  38   1        CKCON |= ILCKE;                     //IRCL时钟使能
  39   1        Delay_ms(1);            //使能IRCL后延时1ms，等待IRCL稳定
  40   1        CKSEL = (CKSEL&0xF8) | CKSEL_IRCL;  //系统时钟切换到IRCL  
  41   1      }
  42          /***********************************************************************************/
  43          
  44          
  45          
  46          /***********************************************************************************
  47          函数名  ：    Sys_Clk_Set_XOSCL                     
  48          功能描述：    设置系统时钟为XOSCL
  49          输入参数：    无
  50          返回值  ：    无
  51          ***********************************************************************************/
  52          void Sys_Clk_Set_XOSCL(void)
C51 COMPILER V9.60.0.0   SYSTEM_CLOCK                                                      06/24/2023 12:55:00 PAGE 2   

  53          {
  54   1        P71F = P71_XOSCL_OUT_SETTING;       //设置P71为晶振引脚
  55   1        P72F = P72_XOSCL_IN_SETTING;        //设置P72为晶振引脚
  56   1        CKCON |= XLCKE;                     //使能XOSCL时钟
  57   1        while(!(CKCON & XLSTA));            //等待XOSCL时钟稳定
  58   1        CKSEL = (CKSEL&0xF8) | CKSEL_XOSCL; //切换系统时钟到XOSCL 
  59   1      }
  60          /***********************************************************************************/
  61          
  62          
  63          
  64          /***********************************************************************************
  65          函数名  ：    Sys_Clk_Set_PLL                     
  66          功能描述：    设置系统时钟为PLL
  67          输入参数：    Multiple   倍频倍数
  68          返回值  ：    无
  69          ***********************************************************************************/
  70          void Sys_Clk_Set_PLL(unsigned char Multiple)  
  71          {
  72   1        if(Multiple < 2 || Multiple > 8) return;    //倍频倍数范围为 2~8，超出此范围返回
  73   1      
  74   1        PLLCON = PLLON(1) | MULFT(Multiple-2);      //设置倍频倍数并使能PLL
  75   1        while(!(PLLCON & PLSTA));                   //等待PLL时钟稳定
  76   1        CKSEL = (CKSEL&0xF8) | CKSEL_PLL;           //切换系统时钟到PLL
  77   1      }
  78          /***********************************************************************************/
  79          
  80          
  81          
  82          /***********************************************************************************
  83          函数名  ：    Sys_Clk_Set_TFRC                      
  84          功能描述：    设置系统时钟为TFRC
  85          输入参数：    无
  86          返回值  ：    无
  87          ***********************************************************************************/
  88          void Sys_Clk_Set_TFRC(void)
  89          {
  90   1        CKCON |= TFCKE;                         //使能TFRC时钟
  91   1        CKSEL = (CKSEL&0xF8) | CKSEL_TFRC;      //切换系统时钟到TFRC
  92   1      }
  93          /***********************************************************************************/
  94          
  95          
  96          /*********************************************************************************************************
             -************/
  97          #endif


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    138    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
